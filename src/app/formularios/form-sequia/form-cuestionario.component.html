<div class="container-fluid mt--9" id="form-cuestionario">
  <div class="row">
    <div class="col-xl-2"></div>
    <div class="col-xl-8 mb-5 mb-xl-0">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title" *ngIf="isUpdating">
            Editar información de cuestionario
          </h3>
          <h3 class="card-title" *ngIf="!isUpdating">
            Crear nuevo cuestionario
          </h3>
        </div>
        <div class="card-body">
          <form #formCuestionario="ngForm" ngNativeValidate>
            <div class="form-group" *ngIf="isUpdating">
              <label for="estacionadmin">Estación*</label><br />
              <input
                type="text"
                class="form-control"
                name="estacionadmin"
                id="estacionadmin"
                value="{{ cuestionario.Observador.Estacion.nombre }}"
                required
                disabled
              />
            </div>
            <div class="form-group" *ngIf="!isUpdating">
              <label for="estacion">Estación*</label><br />
              <select
                name="estacion"
                id="estacion"
                class="form-control"
                [(ngModel)]="cuestionario.estacion"
                required
              >
                <option
                  *ngFor="let estacion of estaciones"
                  [value]="estacion.id"
                >
                  {{ estacion.nombre }}
                </option>
              </select>
            </div>
            <div class="form-group" *ngIf="isUpdating">
              <label for="fechaadmin">Fecha*</label><br />
              <input
                type="text"
                class="form-control"
                name="fechaadmin"
                id="fechaadmin"
                value="{{ date(cuestionario.fecha) }}"
                required
                disabled
              />
            </div>
            <div class="form-group" *ngIf="!isUpdating">
              <label for="fechaInicio">Fecha*</label><br />
              <input
                type="date"
                class="form-control"
                name="fechaInicio"
                id="fechaInicio"
                [(ngModel)]="cuestionario.fecha"
                required
              />
            </div>
            <div class="form-group">
              <label for="respSuelo">Condición de suelo*</label>
              <button
                class="btn btn-secondary btn-xs ml-2 py-1"
                type="button"
                data-toggle="collapse"
                data-target="#suelo"
                aria-expanded="false"
                aria-controls="suelo"
              >
                <i class="fa fa-info"></i>
              </button>
              <div class="collapse" id="suelo">
                <div class="card card-body text-sm">
                  TIP: La humedad del suelo es la cantidad de agua que hay en el
                  suelo. Para responder a esta pregunta, alrededor de su lugar
                  de observación (estación), busque un punto lo más plano
                  posible y expuesto al sol, sin intervención humana (riego).
                  Cuando cae agua al suelo, esta cubre los espacios de aire
                  presentes en el mismo. El suelo está saturado cuando el agua
                  ha cubierto todos estos espacios. ¿Cuál es el contenido de
                  agua en el suelo del lugar seleccionado? ¿Está encharcado
                  (saturado)? Si coloca el dedo, ¿percibe humedad? ¿Qué tal en
                  los primeros 5 cm de profundidad? (húmedo). ¿Qué tal a 10 cm
                  de profundidad? (subhúmedo) ¿Aún no? Las raíces de las plantas
                  generalmente aprovechan los recursos hasta los 50 cm de
                  profundidad. (seco y muy seco) Si las ráfagas de viento
                  desprenden partículas del suelo, es un indicador de erosión.
                </div>
              </div>
              <br />
              <select
                name="respSuelo"
                id="respSuelo"
                class="form-control"
                [(ngModel)]="cuestionario.respSuelo"
                required
              >
                <option value="1">Saturado</option>
                <option value="2">Húmedo</option>
                <option value="3">Subhúmedo</option>
                <option value="4">Normal</option>
                <option value="5">Seco</option>
                <option value="6">Muy Seco</option>
                <option value="7">Erosionable</option>
              </select>
            </div>
            <div class="form-group">
              <label for="respVeg">Condición de la vegetación*</label
              ><button
                class="btn btn-secondary btn-xs ml-2 py-1"
                type="button"
                data-toggle="collapse"
                data-target="#vegetacion"
                aria-expanded="false"
                aria-controls="vegetacion"
              >
                <i class="fa fa-info"></i>
              </button>
              <div class="collapse" id="vegetacion">
                <div class="card card-body text-sm">
                  TIP: Observe el paisaje que se encuentra alrededor de su lugar
                  de observación (estación). Trate de enfocarse en las plantas
                  de ciclo anual (hierbas, cultivos, etc) que se encuentren en
                  áreas naturales o cultivos de secano (sin riego ni
                  intervención humana). Analice la respuesta de estas plantas a
                  la falta de agua: ¿Cómo están sus hojas? ¿hay muerte por
                  déficit hídrico? Las plantas también pueden ser afectadas por
                  exceso de humedad. Si la región está ubicada en una zona árida
                  o desértica, puede evaluar la presencia de estas plantas de
                  ciclo anual como indicador de condiciones húmedas. ¿Hay un
                  reverdecimiento inusual del entorno? ¿Florecimientos?¿Qué
                  tanto?. Si no hay, seleccione la opción "Normal".
                </div>
              </div>
              <br />
              <select
                name="respVeg"
                id="respVeg"
                class="form-control"
                [(ngModel)]="cuestionario.respVeg"
                required
              >
                <option value="1">Clorótica/Aguachinada</option>
                <option value="2">
                  Verde pálido/perdió la intensidad del verdor
                </option>
                <option value="3">Normal (Verde intenso)</option>
                <option value="4">
                  Verde Azulado (Condición de estrés hídrica)
                </option>
                <option value="5">Marchitez sin defoliación</option>
                <option value="6">Marchitez con defoliación</option>
                <option value="7">Marchitez permanente (muerte)</option>
              </select>
            </div>
            <div class="form-group">
              <label for="respPrec">Lluvias percibidas*</label
              ><button
                class="btn btn-secondary btn-xs ml-2 py-1"
                type="button"
                data-toggle="collapse"
                data-target="#lluvias"
                aria-expanded="false"
                aria-controls="lluvias"
              >
                <i class="fa fa-info"></i>
              </button>
              <div class="collapse" id="lluvias">
                <div class="card card-body text-sm">
                  TIP: ¿A lo largo del mes anterior, cómo ha percibido la
                  cantidad de agua precipitada (lluvías, aguanieve, granizo,
                  nieve, etc)?
                </div>
              </div>
              <br />
              <select
                name="respPrec"
                id="respPrec"
                class="form-control"
                [(ngModel)]="cuestionario.respPrec"
                required
              >
                <option value="1">Mucho más de lo normal</option>
                <option value="2">Más de lo normal</option>
                <option value="3">Poco más de lo normal</option>
                <option value="4">Normal</option>
                <option value="5">Poco menos que lo normal</option>
                <option value="6">Menos que lo normal</option>
                <option value="7">Mucho menos que lo normal</option>
              </select>
            </div>
            <div class="form-group">
              <label for="respTempPrec"
                >Temporalidad de las precipitaciones*</label
              ><button
                class="btn btn-secondary btn-xs ml-2 py-1"
                type="button"
                data-toggle="collapse"
                data-target="#temporalidad"
                aria-expanded="false"
                aria-controls="temporalidad"
              >
                <i class="fa fa-info"></i>
              </button>
              <div class="collapse" id="temporalidad">
                <div class="card card-body text-sm">
                  TIP: De acuerdo con la región donde está ubicado su lugar de
                  observación (estación), ¿A lo largo del mes anterior, han
                  ocurrido precipitaciones (lluvías, aguanieve, granizo, nieve,
                  etc) fuera de temporada?¿Qué tan intensas han sido?
                </div>
              </div>
              <br />
              <select
                name="respTempPrec"
                id="respTempPrec"
                class="form-control"
                [(ngModel)]="cuestionario.respTempPrec"
                required
              >
                <option value="1">Muy adelantadas</option>
                <option value="2">Más adelantadas de lo normal</option>
                <option value="3">Poco más adelantadas de lo normal</option>
                <option value="4">Normal</option>
                <option value="5">Ligeramente retrasadas de lo normal</option>
                <option value="6">Más retrasadas de lo normal</option>
                <option value="7">Muy retrasadas</option>
              </select>
            </div>
            <div class="form-group">
              <label for="respTemps">Temperaturas observadas*</label
              ><button
                class="btn btn-secondary btn-xs ml-2 py-1"
                type="button"
                data-toggle="collapse"
                data-target="#temperaturas"
                aria-expanded="false"
                aria-controls="temperaturas"
              >
                <i class="fa fa-info"></i>
              </button>
              <div class="collapse" id="temperaturas">
                <div class="card card-body text-sm">
                  TIP: ¿A lo largo del mes anterior, en general, cómo ha
                  percibido la temperatura?
                </div>
              </div>
              <br />
              <select
                name="respTemps"
                id="respTemps"
                class="form-control"
                [(ngModel)]="cuestionario.respTemps"
                required
              >
                <option value="1">Mucho más frío de lo normal</option>
                <option value="2">Más frío de lo normal</option>
                <option value="3">Poco más frío de lo normal</option>
                <option value="4">Normal</option>
                <option value="5">Poco más cálido que lo normal</option>
                <option value="6">Más cálido que lo normal</option>
                <option value="7">Mucho más cálido que lo normal</option>
              </select>
            </div>
            <div class="form-group">
              <label for="respGana">Disponibilidad de agua*</label
              ><button
                class="btn btn-secondary btn-xs ml-2 py-1"
                type="button"
                data-toggle="collapse"
                data-target="#agua"
                aria-expanded="false"
                aria-controls="agua"
              >
                <i class="fa fa-info"></i>
              </button>
              <div class="collapse" id="agua">
                <div class="card card-body text-sm">
                  TIP: En la región donde está ubicado su lugar de observación
                  (estación), durante el mes anterior, ¿Hay inconvenientes que
                  estén teniendo los agricultores o ganaderos en la provisión de
                  agua? ¿Ha sufrido de algún corte del suministro hídrico debido
                  a problemas en la cantidad de agua de las fuentes de
                  provisión? ¿o escuchado noticias de alerta? ¿Cómo están los
                  niveles o caudales de ríos, lagos, embalses, pozos que se
                  encuentran en los alrededores?
                </div>
              </div>
              <br />
              <select
                name="respGana"
                id="respGana"
                class="form-control"
                [(ngModel)]="cuestionario.respGana"
                required
              >
                <option value="1">Mucho más que suficiente</option>
                <option value="2">Más que suficiente</option>
                <option value="3">Poco más que suficiente</option>
                <option value="4">Sufuciente</option>
                <option value="5">Poco menos que suficiente</option>
                <option value="6">Menos que suficiente (escasa)</option>
                <option value="7">Mucho menos que suficiente</option>
              </select>
            </div>
            <div class="form-group">
              <label for="comentario">Comentario</label><br />
              <textarea
                name="comentario"
                id="comentario"
                class="form-control"
                [(ngModel)]="cuestionario.comentario"
              ></textarea>
            </div>
            <div class="row">
              <div class="col-md-12">
                <label for="file">Archivo</label><br />
                <input
                  *ngIf="uploader.queue.length < 4"
                  type="file"
                  class="input-group custom-file-upload mb-4"
                  ng2FileSelect
                  [uploader]="uploader"
                  accept=".jpg, .jpeg, .png"
                  multiple
                />
              </div>
              <div class="col-12" *ngIf="uploader.queue.length != 0">
                <table class="table">
                  <thead class="thead-light">
                    <tr>
                      <th scope="col">Nombre</th>
                      <th scope="col">Estado</th>
                      <th scope="col">Acciones</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let item of uploader.queue">
                      <td scope="row" class="text-wrap">
                        <strong>{{ item?.file?.name }}</strong
                        ><br />
                        <img
                          *ngIf="!ifFoto(item)"
                          [src]="getPreview(item)"
                          class="img-thumbnail img-max"
                        />
                        <img
                          *ngIf="ifFoto(item)"
                          src="data:image/png;base64,{{ getBuffer(item) }}"
                          class="img-thumbnail img-max"
                        />
                      </td>
                      <td class="text-center">
                        <span *ngIf="item.isUploading"
                          ><i class="fa fa-spinner"></i
                        ></span>
                        <span *ngIf="item.isSuccess"
                          ><i class="fa fa-check-circle"></i
                        ></span>
                        <span *ngIf="item.isCancel"
                          ><i class="fa fa-times-circle text-black"></i
                        ></span>
                        <span *ngIf="item.isError"
                          ><i class="fa fa-exclamation-circle text-black"></i
                        ></span>
                      </td>
                      <td nowrap>
                        <button
                          type="button"
                          class="btn btn-danger btn-xs"
                          (click)="removeItem(item)"
                        >
                          <span class="fa fa-trash"></span> Eliminar
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div class="progress-wrapper pt-0">
                  <div class="progress-info">
                    <div class="progress-label">
                      <span>Progreso</span>
                    </div>
                    <div class="progress-percentage">
                      <span>{{ uploader.progress + "%" }}</span>
                    </div>
                  </div>
                  <div class="progress">
                    <div
                      class="progress-bar"
                      role="progressbar"
                      [ngStyle]="{ width: uploader.progress + '%' }"
                    ></div>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <button
                class="btn btn-secondary float-left"
                (click)="cancelar(formCuestionario)"
              >
                Cancelar
              </button>
              <button
                class="btn btn-default float-right"
                (click)="saveCuestionario(formCuestionario)"
              >
                Guardar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
